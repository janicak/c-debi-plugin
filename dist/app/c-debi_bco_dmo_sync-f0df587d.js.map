{"version":3,"sources":["webpack:///./src/Admin/BcoDmoSync/utilities.js","webpack:///./src/Admin/BcoDmoSync/features/form/formSlice.js","webpack:///./src/Admin/BcoDmoSync/store/reducers.js","webpack:///./src/Admin/BcoDmoSync/store/index.js","webpack:///./src/Admin/BcoDmoSync/features/form/FormSection.js","webpack:///./src/Admin/BcoDmoSync/sharedComponents/LoadingEllipsis.js","webpack:///./src/Admin/BcoDmoSync/features/form/Sync.js","webpack:///./src/Admin/BcoDmoSync/features/form/LinkPeople.js","webpack:///./src/Admin/BcoDmoSync/features/form/FormExplanation.mdx","webpack:///./src/Admin/BcoDmoSync/features/form/Form.js","webpack:///./src/Admin/BcoDmoSync/App.js","webpack:///./src/Admin/BcoDmoSync/index.js"],"names":["wp_ajax_fetch","reqs","window","c_debi_plugin","ajax_url","action","nonce","route","Promise","resolve","reject","axios","method","url","headers","data","qs","stringify","then","res","success","catch","error","syncEntities","createAsyncThunk","args","thunkAPI","triggerSync","setTimeout","dispatch","getSyncStatus","a","response","getState","form","loading","linkPeople","triggerLinkPeople","formSlice","createSlice","name","initialState","syncStatusMessage","syncStatusPercentage","unlinkedPeople","linkPeopleStatusMessage","reducers","extraReducers","pending","state","console","log","rejected","fulfilled","payload","statusMessage","statusPercentage","hasOwnProperty","datasets","data_projects","created","updated","unlinked_people","unlinked_people_count","Object","keys","length","rows_updated","people_created","parseInt","combineReducers","formReducer","configureAppStore","configureStore","reducer","rootReducer","StyledDiv","styled","div","FormSection","heading","children","ellipsis","keyframes","StyledLoadingEllipsis","LoadingEllipsis","StyledSyncForm","SyncForm","useSelector","useDispatch","useForm","register","handleSubmit","getValues","useState","formDisabled","setFormDisabled","triggerSyncSelected","setTriggerSyncSelected","onInputChange","formValues","trigger_sync","anyChecked","find_unlinked_people","onSubmit","className","type","ref","defaultChecked","onChange","value","disabled","StyledSyncStatusIndicator","SyncStatusIndicator","style","width","Sync","StyledLinkPeople","connect","entries","map","bcoDmoName","person","instances","parsed_name","create_new","selected_entity","key","matched_person_posts","text","post_title","ID","layoutProps","MDXContent","components","props","mdxType","parentName","isMDXComponent","StyledForm","Form","App","ReactDOM","render","StrictMode","store","document","getElementById"],"mappings":"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","file":"app/c-debi_bco_dmo_sync-f0df587d.js","sourcesContent":["import axios from \"axios\"\r\nimport qs from \"qs\"\r\n\r\nexport const triggerSync = (args) => (\r\n  wp_ajax_fetch([{\r\n    method: 'trigger_bcodmo_sync',\r\n    args\r\n  }])\r\n)\r\n\r\nexport const triggerGetSyncStatus = () => (\r\n  wp_ajax_fetch([{ method: 'check_bcodmo_sync_status' }])\r\n)\r\n\r\nexport const triggerLinkPeople = (args) => (\r\n  wp_ajax_fetch([{\r\n    method: 'trigger_link_people',\r\n    args\r\n  }])\r\n)\r\n\r\nconst wp_ajax_fetch = ( reqs ) => {\r\n  const { ajax_url, action, nonce, route } = window.c_debi_plugin\r\n\r\n  return new Promise((resolve, reject) => {\r\n    axios({\r\n      method: 'POST',\r\n      url: ajax_url,\r\n      headers: { 'content-type': 'application/x-www-form-urlencoded' },\r\n      data: qs.stringify({\r\n        action,\r\n        nonce,\r\n        route,\r\n        reqs\r\n      })\r\n    }).then(res => {\r\n      if (res.data.success) {\r\n        resolve(res.data.data)\r\n      } else {\r\n        reject(res.data.data)\r\n      }\r\n    })\r\n    .catch(error => reject(error))\r\n  })\r\n\r\n}","import { createAsyncThunk, createSlice } from '@reduxjs/toolkit'\r\nimport { triggerSync, triggerGetSyncStatus, triggerLinkPeople } from \"../../utilities\"\r\n\r\nexport const syncEntities = createAsyncThunk(\r\n  'form/syncEntities',\r\n  (args, thunkAPI) => {\r\n    return new Promise((resolve, reject) => {\r\n      triggerSync(args).then(data => {\r\n        resolve(data)\r\n      }, error => {\r\n        reject(error)\r\n      })\r\n      window.setTimeout(() => {\r\n        thunkAPI.dispatch(getSyncStatus())\r\n      }, 2000)\r\n    })\r\n  }\r\n)\r\n\r\nconst getSyncStatus = createAsyncThunk(\r\n  'form/getSyncStatus',\r\n  async (args, thunkAPI) => {\r\n    const response = await triggerGetSyncStatus()\r\n    window.setTimeout(() => {\r\n      if (thunkAPI.getState().form.loading){\r\n        thunkAPI.dispatch(getSyncStatus())\r\n      }\r\n    }, 2000)\r\n    return response\r\n  }\r\n)\r\n\r\nexport const linkPeople = createAsyncThunk(\r\n  'form/linkPeople',\r\n  (args) => ( triggerLinkPeople(args) )\r\n)\r\n\r\nconst formSlice = createSlice({\r\n  name: 'form',\r\n  initialState: {\r\n    loading: false,\r\n    syncStatusMessage: '',\r\n    syncStatusPercentage: 0,\r\n    unlinkedPeople: {},\r\n    linkPeopleStatusMessage: ''\r\n  },\r\n  reducers: {},\r\n  extraReducers: {\r\n    [syncEntities.pending]: (state, action) => {\r\n      console.log(action)\r\n      state.loading = true\r\n      state.syncStatusMessage = \"Starting BCO-DMO update\"\r\n      state.syncStatusPercentage = 0\r\n      state.unlinkedPeople = {}\r\n      state.linkPeopleStatusMessage  = ''\r\n    },\r\n    [getSyncStatus.pending]: (state, action) => {\r\n      console.log(action)\r\n    },\r\n    [getSyncStatus.rejected]: (state, action) => {\r\n      console.log(action)\r\n    },\r\n    [getSyncStatus.fulfilled]: (state, action) => {\r\n      if (state.loading){\r\n        console.log(action)\r\n        state.syncStatusMessage = action.payload.statusMessage\r\n        state.syncStatusPercentage = action.payload.statusPercentage\r\n      }\r\n    },\r\n    [syncEntities.rejected]: (state, action) => {\r\n      console.log(action)\r\n      state.loading = false\r\n      state.syncStatusMessage = `Error: ${action.payload}`\r\n      state.syncStatusPercentage = 0\r\n    },\r\n    [syncEntities.fulfilled]: (state, action) => {\r\n      console.log(action)\r\n      state.loading = false\r\n      state.syncStatusPercentage = 100\r\n\r\n      state.syncStatusMessage = \"Completed. \"\r\n\r\n      if (action.payload.hasOwnProperty('datasets') && action.payload.hasOwnProperty('data_projects')){\r\n        const { datasets, data_projects } = action.payload\r\n        state.syncStatusMessage += ` \r\n          Datasets: ${datasets.created} created, ${datasets.updated} updated;\r\n          Data Projects: ${data_projects.created} created, ${data_projects.updated} updated. `\r\n      }\r\n\r\n      if (action.payload.hasOwnProperty('unlinked_people')){\r\n        const { unlinked_people } = action.payload\r\n        state.unlinkedPeople = unlinked_people\r\n        const unlinked_people_count = Object.keys(unlinked_people).length\r\n        state.syncStatusMessage += `${unlinked_people_count} unlinked ${unlinked_people_count === 1 ? 'person' : 'people'} returned. `\r\n      }\r\n\r\n    },\r\n    [linkPeople.pending]: (state, action) => {\r\n      console.log(action)\r\n      state.loading = true\r\n      state.linkPeopleStatusMessage = \"Updating\"\r\n    },\r\n    [linkPeople.rejected]: (state, action) => {\r\n      console.log(action)\r\n      state.loading = false\r\n      state.linkPeopleStatusMessage = `Error: ${action.payload}`\r\n    },\r\n    [linkPeople.fulfilled]: (state, action) => {\r\n      console.log(action)\r\n      state.loading = false\r\n      const { rows_updated, people_created } = action.payload;\r\n      state.linkPeopleStatusMessage = `Completed. \r\n        ${rows_updated} ${ parseInt(people_created) === 1 ? 'row' : 'rows' } updated; \r\n        ${people_created} ${ parseInt(people_created) === 1 ? 'person' : 'people' } created.`\r\n    },\r\n  }\r\n})\r\n\r\nexport default formSlice.reducer","import { combineReducers } from 'redux'\r\nimport formReducer from '../features/form/formSlice'\r\n\r\nexport default combineReducers({\r\n  form: formReducer,\r\n})\r\n","import { configureStore } from '@reduxjs/toolkit'\r\n\r\nimport rootReducer from './reducers'\r\n\r\nfunction configureAppStore() {\r\n  const store = configureStore({\r\n    reducer: rootReducer,\r\n  })\r\n\r\n  if (process.env.NODE_ENV !== 'production' && module.hot) {\r\n    module.hot.accept('./reducers', () => store.replaceReducer(rootReducer))\r\n  }\r\n\r\n  return store\r\n}\r\n\r\nexport default configureAppStore()","import React from 'react'\r\nimport styled from 'styled-components'\r\n\r\nconst StyledDiv = styled.div`\r\n  margin-top: 16px;\r\n  background-color: white;\r\n  padding: 1rem 1rem;\r\n  border: 1px solid #ccd0d4;\r\n  box-shadow: 0 1px 1px rgba(0,0,0,.04);\r\n  h2 {\r\n    margin-top: 0;\r\n  }\r\n`\r\nconst FormSection = ({heading, children}) => (\r\n  <StyledDiv>\r\n    <h2>{heading}</h2>\r\n    { children }\r\n  </StyledDiv>\r\n)\r\n\r\nexport default FormSection","import React from 'react'\r\nimport styled, { keyframes } from 'styled-components'\r\n\r\n\r\nconst ellipsis = keyframes`\r\n  to {\r\n    width: 1em;    \r\n  }\r\n`\r\nconst StyledLoadingEllipsis = styled('span')`\r\n  &:after {\r\n    overflow: hidden;\r\n    display: inline-block;\r\n    vertical-align: bottom;\r\n    animation: ${ellipsis} steps(4,end) 2000ms infinite;\r\n    content: \"\\\\2026\"; /* ascii code for the ellipsis character */\r\n    width: 0px;\r\n  }\r\n`\r\nconst LoadingEllipsis = () => (\r\n  <StyledLoadingEllipsis />\r\n)\r\n\r\nexport default LoadingEllipsis","import React, { useState } from 'react'\r\nimport styled from 'styled-components'\r\nimport { useSelector, useDispatch } from \"react-redux\"\r\nimport { useForm } from 'react-hook-form'\r\nimport { syncEntities } from \"./formSlice\"\r\nimport FormSection from \"./FormSection\"\r\nimport LoadingEllipsis from \"../../sharedComponents/LoadingEllipsis\"\r\n\r\nconst StyledSyncForm = styled.form`\r\n  & > label {\r\n    font-weight: bold;\r\n  }\r\n  .options {\r\n    margin-top: 4px;\r\n    display: flex;\r\n    flex-direction: column;\r\n    label {\r\n      margin-right: 8px;\r\n      input {\r\n        position: relative;\r\n        top: 1px;\r\n      }\r\n    }\r\n    .subOptions {\r\n      margin-left: 19px;\r\n      margin-top: 2px;\r\n      margin-bottom: 5px;\r\n    }\r\n  }\r\n  input.button-primary {\r\n    margin-top: 12px;\r\n    width: 150px;\r\n  }\r\n`\r\nconst SyncForm = () => {\r\n  const { loading } = useSelector(state => state.form)\r\n  const dispatch = useDispatch()\r\n  const { register, handleSubmit, getValues } = useForm()\r\n  const [ formDisabled, setFormDisabled ] = useState(loading)\r\n  const [ triggerSyncSelected, setTriggerSyncSelected ] = useState(true)\r\n\r\n  const onInputChange = () => {\r\n    const formValues = getValues()\r\n    setTriggerSyncSelected(formValues.trigger_sync)\r\n\r\n    const anyChecked = formValues.trigger_sync || formValues.find_unlinked_people\r\n    setFormDisabled(!anyChecked || loading)\r\n  }\r\n\r\n  const onFormSubmit = data =>{\r\n    dispatch(syncEntities(data))\r\n  }\r\n\r\n  return(\r\n    <StyledSyncForm onSubmit={handleSubmit(onFormSubmit)}>\r\n      <label>Options: </label>\r\n      <div className=\"options\">\r\n        <label>\r\n          <input type=\"checkbox\" ref={register} name=\"trigger_sync\" defaultChecked  onChange={() => onInputChange() }/>\r\n          Update / create local Datasets, Projects\r\n          <div className={`subOptions${triggerSyncSelected ? '' : ' hidden'}`}>\r\n            <label>\r\n              <input type=\"radio\" ref={register} name=\"use_cache\" value=\"false\" defaultChecked />\r\n              Fetch latest metadata from remote server\r\n            </label>\r\n            <label>\r\n              <input type=\"radio\" ref={register} name=\"use_cache\" value=\"true\" />\r\n              Used last cached response from remote server\r\n            </label>\r\n          </div>\r\n        </label>\r\n        <label>\r\n          <input type=\"checkbox\" ref={register} name=\"find_unlinked_people\" defaultChecked onChange={() => onInputChange() }/>\r\n          Link remote metadata with local Person entities, and return form to manually pair novel entries\r\n        </label>\r\n      </div>\r\n      <input className=\"button-primary\" type=\"submit\" value=\"Submit\" disabled={formDisabled} />\r\n    </StyledSyncForm>\r\n  )\r\n}\r\n\r\nconst StyledSyncStatusIndicator = styled.div`\r\n  margin-top: 12px;\r\n  label {\r\n    font-weight: bold;\r\n  }\r\n  .progress-bar {\r\n    height: 15px;\r\n    width: 100%;\r\n    margin-top: 4px;\r\n    box-shadow: inset 0.75px 0.5px 4px 0px #4c4c4cc2;\r\n    .progress-bar-fill {\r\n      background: #007cba87;\r\n      height: 100%;\r\n      transition: width .5s ease-in;\r\n    }\r\n  }\r\n  .status-message {\r\n    margin-top: 3px;\r\n    .message {\r\n      margin-right: 3px;\r\n      font-style: italic;\r\n    }\r\n  } \r\n`\r\nconst SyncStatusIndicator = () => {\r\n  const {\r\n    loading,\r\n    syncStatusMessage: statusMessage,\r\n    syncStatusPercentage: statusPercentage\r\n  } = useSelector(state => state.form)\r\n\r\n  return (\r\n    <StyledSyncStatusIndicator>\r\n      <label>Progress: </label>\r\n      <div className=\"progress-bar\">\r\n        <div className=\"progress-bar-fill\" style={{width: `${statusPercentage}%`}}/>\r\n      </div>\r\n      <div className=\"status-message\">\r\n        <span className=\"message\">{statusMessage}</span>\r\n        { loading && <LoadingEllipsis />}\r\n      </div>\r\n    </StyledSyncStatusIndicator>\r\n  )\r\n}\r\n\r\nconst Sync = () => (\r\n  <FormSection heading={'Part 1: Reconcile remote (BCO-DMO) and local (website) metadata'}>\r\n    <SyncForm />\r\n    <SyncStatusIndicator />\r\n  </FormSection>\r\n)\r\n\r\nexport default Sync","import React, { useState } from 'react'\r\nimport styled from 'styled-components'\r\nimport FormSection from \"./FormSection\"\r\nimport { connect, useSelector } from \"react-redux\"\r\nimport { useForm } from 'react-hook-form'\r\nimport { linkPeople } from \"./formSlice\"\r\nimport LoadingEllipsis from \"../../sharedComponents/LoadingEllipsis\"\r\n\r\nconst StyledLinkPeople = styled.form`\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: flex-start;\r\n  table {\r\n    border: 1px solid #ccd0d4;\r\n    box-shadow: 0 1px 1px rgba(0,0,0,.04);\r\n    background: #e6e6e6;\r\n    width: 100%;\r\n    border-spacing: 0;\r\n    thead tr th {\r\n      height: 24px;\r\n      background-color: white;\r\n      text-align: left;\r\n      &:first-child {\r\n        min-width: 125px;\r\n      }\r\n    }\r\n    td, th {\r\n      padding: 8px 10px;\r\n    }\r\n    tbody {\r\n     tr {\r\n      &:nth-child(even) {\r\n        background-color:white;\r\n      }\r\n      td {\r\n        &:first-child {\r\n          width:1%;\r\n          white-space:nowrap;\r\n        }\r\n        select {\r\n          width: 100%;\r\n          max-width: unset;\r\n        }\r\n      }\r\n     }\r\n    }\r\n  }\r\n  input.button-primary {\r\n    margin-top: 16px;\r\n    width: 150px;\r\n  }\r\n  .status-message {\r\n    margin-top: 3px;\r\n    font-style: italic;\r\n  }\r\n`\r\nconst LinkPeople = ({ linkPeople }) => {\r\n  const { unlinkedPeople, loading, linkPeopleStatusMessage } = useSelector(state => state.form)\r\n  const { register, handleSubmit, getValues } = useForm()\r\n  const [ formDisabled, setFormDisabled ] = useState(loading)\r\n\r\n  const onFormSubmit = data =>{\r\n\r\n    const args = Object.entries(unlinkedPeople).map(([bcoDmoName, person]) => {\r\n      const {instances, parsed_name} = person\r\n      const create_new = data[bcoDmoName] === 'create_new'\r\n      const selected_entity = data[bcoDmoName] !== 'create_new' ? data[bcoDmoName] : null\r\n      return {\r\n          instances,\r\n          selected_entity,\r\n          create_new,\r\n          parsed_name\r\n        }\r\n    })\r\n    linkPeople(args).then(() => {\r\n      setFormDisabled(false)\r\n    })\r\n    setFormDisabled(true)\r\n  }\r\n\r\n  return(\r\n    <>\r\n      {unlinkedPeople && Object.entries(unlinkedPeople).length ? (\r\n        <FormSection heading={`Part 2: Link unpaired, BCO-DMO people with new or existing, local entities`}>\r\n          <StyledLinkPeople onSubmit={handleSubmit(onFormSubmit)}>\r\n            <table>\r\n              <thead><tr><th>BCO-DMO people</th><th>Local entity matches</th></tr></thead>\r\n              <tbody>\r\n              {Object.entries(unlinkedPeople).map(([bcoDmoName, person]) => (\r\n                <tr key={bcoDmoName}>\r\n                  <td>{bcoDmoName}</td>\r\n                  <td><select name={bcoDmoName} ref={register}>\r\n                    { person.matched_person_posts.length && (\r\n                      person.matched_person_posts.map(({ post_title: text, ID: value }) => (\r\n                        <option key={value} value={value}>{text} [ID: {value}]</option>\r\n                      ))\r\n                    )}\r\n                    <option value=\"create_new\">Create new person: \"{person.parsed_name.post_title}\"</option>\r\n                  </select></td>\r\n                </tr>\r\n              ))}\r\n              </tbody>\r\n            </table>\r\n            <input className=\"button-primary\" type=\"submit\" value=\"Link People\" disabled={formDisabled} />\r\n            <div className=\"status-message\">\r\n              <span className=\"message\">{linkPeopleStatusMessage}</span>\r\n              { loading && <LoadingEllipsis />}\r\n            </div>\r\n          </StyledLinkPeople>\r\n        </FormSection>\r\n      ) : ''}\r\n    </>\r\n  )\r\n}\r\n\r\nexport default connect(null, { linkPeople } )(LinkPeople)","\nimport React from 'react'\nimport { mdx } from '@mdx-js/react'\n\n/* @jsx mdx */\n\n\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  \n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n    <p>{`Use this form to `}<em parentName=\"p\">{`update`}</em>{` the website's `}<a parentName=\"p\" {...{\n        \"href\": \"./edit.php?post_type=dataset\"\n      }}>{`dataset`}</a>{`\nand `}<a parentName=\"p\" {...{\n        \"href\": \"./edit.php?post_type=data_project\"\n      }}>{`data project`}</a>{` entities with BCO-DMO's\n`}<a parentName=\"p\" {...{\n        \"href\": \"https://www.bco-dmo.org/program/554979\"\n      }}>{`C-DEBI Program-affiliated`}</a>{`\ndatasets and projects. Where person names from the source data are unconnected to\n`}<a parentName=\"p\" {...{\n        \"href\": \"./edit.php?post_type=person\"\n      }}>{`People`}</a>{` entities on the website, you will be presented\nwith a form to confirm matches.`}</p>\n    <div className=\"notice notice-warning inline\">\n      <p>{`This will overwrite the website's data. `}<em parentName=\"p\">{`Backup the database if you want an undo`}</em>{`.`}</p>\n    </div>\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;","import React from 'react'\r\nimport styled from 'styled-components'\r\nimport Sync from './Sync'\r\nimport LinkPeople from \"./LinkPeople\"\r\nimport FormExplanation from \"./FormExplanation.mdx\"\r\n\r\nconst StyledForm = styled.div`\r\n  max-width: 800px;\r\n`\r\nconst Form = () => {\r\n  return(\r\n    <StyledForm >\r\n      <FormExplanation />\r\n      <Sync />\r\n      <LinkPeople />\r\n    </StyledForm >\r\n  )\r\n}\r\n\r\nexport default Form","import React from 'react'\r\nimport { hot } from 'react-hot-loader'\r\nimport Form from './features/form/Form'\r\n\r\nfunction App() {\r\n  return (\r\n    <Form />\r\n  )\r\n}\r\n\r\nexport default hot(module)(App)\r\n","import React from 'react'\r\nimport ReactDOM from 'react-dom'\r\nimport { Provider } from 'react-redux'\r\n\r\nimport store from './store'\r\nimport App from './App'\r\n\r\nReactDOM.render(\r\n  <React.StrictMode>\r\n      <Provider store={store}>\r\n          <App />\r\n      </Provider>\r\n  </React.StrictMode>,\r\n  document.getElementById('react-root')\r\n)"],"sourceRoot":""}